// license : MIT

//     (c) 2009-2011 Jeremy Ashkenas, DocumentCloud Inc.

//     (c) 2011-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors

//     Underscore may be freely distributed under the MIT license.

/**
 * @license RequireJS text 2.0.7 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

define("constants",[],function(){var e={};return e.DEBUG=!1,e.CORE={APP_VERSION:"1.1.2",RELEASE_DATE:"Aug 31, 2013",GITHUB_URL:"https://github.com/benkeen/birdsearch.org"},e.EVENT={ABOUT_LINK_CLICK:"aboutDialog-link-click",TAB_CHANGED:"tab-changed",SELECT_TAB:"select-tab",WINDOW_RESIZE:"window-resize",TRIGGER_WINDOW_RESIZE:"trigger-window-resize",SEARCH_TYPE_CHANGED:"search-type-changed",SEARCH:"search",INIT_SEARCH:"init-search",BIRD_SIGHTINGS_LOADED:"bird-sightings-loaded",MAP:{BIRD_MARKERS_ADDED:"map-bird-markers-added",NOTABLE_MARKERS_ADDED:"map-notable-markers-added",HOTSPOT_MARKERS_ADDED:"map-hotspot-markers-added",VIEW_NOTABLE_SIGHTING_SINGLE_LOCATION:"view-notable-sighting-single-location",VIEW_SIGHTINGS_SINGLE_LOCATION:"view-sightings-single-location"},LOCATION_MOUSEOVER:"location-mouseover",LOCATION_MOUSEOUT:"location-mouseout",LOCATION_CLICK:"location-click"},e.SETTINGS={DEFAULT_SEARCH_DAY:7,NUM_SEARCH_DAYS:30},e}),define("mediator",["constants"],function(e){var t={},n=function(){r(),i()},r=function(){for(var e in t)t[e].init()},i=function(){for(var e in t)t[e].run()},s=function(n,r){if(t.hasOwnProperty(n)){console.warn("A module with this ID is already registered: ",n);return}var i=$.extend({init:function(){},run:function(){},subscriptions:{}},r);t[n]=i,e.DEBUG&&console.log("registered: ",n)},o=function(n,r,i){e.DEBUG&&console.log("["+n+"] publish(): ",r,i);for(var s in t){var o=t[s].subscriptions;o.hasOwnProperty(r)&&o[r]({sender:n,data:i})}},u=function(e,n){t[e].subscriptions=n};return{start:n,register:s,publish:o,subscribe:u}}),define("page",["mediator","constants"],function(e,t){var n="page",r=640,i=function(){$(window).resize(s);var r={};r[t.EVENT.TRIGGER_WINDOW_RESIZE]=s,e.subscribe(n,r)},s=function(){var i=$(window).height(),s=$(window).width(),o="desktop";s<r&&(o="mobile"),e.publish(n,t.EVENT.WINDOW_RESIZE,{viewportMode:o,width:s,height:i})};e.register(n,{init:i})}),define("moment",[],function(){return function(e){function t(e,t){return function(n){return a(e.call(this,n),t)}}function n(e){return function(t){return this.lang().ordinal(e.call(this,t))}}function r(){}function i(e){o(this,e)}function s(e){var t=this._data={},n=e.years||e.year||e.y||0,r=e.months||e.month||e.M||0,i=e.weeks||e.week||e.w||0,s=e.days||e.day||e.d||0,o=e.hours||e.hour||e.h||0,a=e.minutes||e.minute||e.m||0,f=e.seconds||e.second||e.s||0,l=e.milliseconds||e.millisecond||e.ms||0;this._milliseconds=l+f*1e3+a*6e4+o*36e5,this._days=s+i*7,this._months=r+n*12,t.milliseconds=l%1e3,f+=u(l/1e3),t.seconds=f%60,a+=u(f/60),t.minutes=a%60,o+=u(a/60),t.hours=o%24,s+=u(o/24),s+=i*7,t.days=s%30,r+=u(s/30),t.months=r%12,n+=u(r/12),t.years=n}function o(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function u(e){return e<0?Math.ceil(e):Math.floor(e)}function a(e,t){var n=e+"";while(n.length<t)n="0"+n;return n}function f(e,t,n){var r=t._milliseconds,i=t._days,s=t._months,o;r&&e._d.setTime(+e+r*n),i&&e.date(e.date()+i*n),s&&(o=e.date(),e.date(1).month(e.month()+s*n).date(Math.min(o,e.daysInMonth())))}function l(e){return Object.prototype.toString.call(e)==="[object Array]"}function c(e,t){var n=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),i=0,s;for(s=0;s<n;s++)~~e[s]!==~~t[s]&&i++;return i+r}function h(e,t){return t.abbr=e,H[e]||(H[e]=new r),H[e].set(t),H[e]}function p(e){return e?(!H[e]&&B&&require("./lang/"+e),H[e]):M.fn._lang}function d(e){return e.match(/\[.*\]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function v(e){var t=e.match(F),n,r;for(n=0,r=t.length;n<r;n++)st[t[n]]?t[n]=st[t[n]]:t[n]=d(t[n]);return function(i){var s="";for(n=0;n<r;n++)s+=typeof t[n].call=="function"?t[n].call(i,e):t[n];return s}}function m(e,t){function n(t){return e.lang().longDateFormat(t)||t}var r=5;while(r--&&I.test(t))t=t.replace(I,n);return nt[t]||(nt[t]=v(t)),nt[t](e)}function g(e){switch(e){case"DDDD":return z;case"YYYY":return W;case"YYYYY":return X;case"S":case"SS":case"SSS":case"DDD":return U;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":case"a":case"A":return V;case"X":return K;case"Z":case"ZZ":return $;case"T":return J;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return R;default:return new RegExp(e.replace("\\",""))}}function y(e,t,n){var r,i,s=n._a;switch(e){case"M":case"MM":s[1]=t==null?0:~~t-1;break;case"MMM":case"MMMM":r=p(n._l).monthsParse(t),r!=null?s[1]=r:n._isValid=!1;break;case"D":case"DD":case"DDD":case"DDDD":t!=null&&(s[2]=~~t);break;case"YY":s[0]=~~t+(~~t>68?1900:2e3);break;case"YYYY":case"YYYYY":s[0]=~~t;break;case"a":case"A":n._isPm=(t+"").toLowerCase()==="pm";break;case"H":case"HH":case"h":case"hh":s[3]=~~t;break;case"m":case"mm":s[4]=~~t;break;case"s":case"ss":s[5]=~~t;break;case"S":case"SS":case"SSS":s[6]=~~(("0."+t)*1e3);break;case"X":n._d=new Date(parseFloat(t)*1e3);break;case"Z":case"ZZ":n._useUTC=!0,r=(t+"").match(Z),r&&r[1]&&(n._tzh=~~r[1]),r&&r[2]&&(n._tzm=~~r[2]),r&&r[0]==="+"&&(n._tzh=-n._tzh,n._tzm=-n._tzm)}t==null&&(n._isValid=!1)}function b(e){var t,n,r=[];if(e._d)return;for(t=0;t<7;t++)e._a[t]=r[t]=e._a[t]==null?t===2?1:0:e._a[t];r[3]+=e._tzh||0,r[4]+=e._tzm||0,n=new Date(0),e._useUTC?(n.setUTCFullYear(r[0],r[1],r[2]),n.setUTCHours(r[3],r[4],r[5],r[6])):(n.setFullYear(r[0],r[1],r[2]),n.setHours(r[3],r[4],r[5],r[6])),e._d=n}function w(e){var t=e._f.match(F),n=e._i,r,i;e._a=[];for(r=0;r<t.length;r++)i=(g(t[r]).exec(n)||[])[0],i&&(n=n.slice(n.indexOf(i)+i.length)),st[t[r]]&&y(t[r],i,e);e._isPm&&e._a[3]<12&&(e._a[3]+=12),e._isPm===!1&&e._a[3]===12&&(e._a[3]=0),b(e)}function E(e){var t,n,r,s=99,u,a,f;while(e._f.length){t=o({},e),t._f=e._f.pop(),w(t),n=new i(t);if(n.isValid()){r=n;break}f=c(t._a,n.toArray()),f<s&&(s=f,r=n)}o(e,r)}function S(e){var t,n=e._i;if(Q.exec(n)){e._f="YYYY-MM-DDT";for(t=0;t<4;t++)if(Y[t][1].exec(n)){e._f+=Y[t][0];break}$.exec(n)&&(e._f+=" Z"),w(e)}else e._d=new Date(n)}function x(t){var n=t._i,r=j.exec(n);n===e?t._d=new Date:r?t._d=new Date(+r[1]):typeof n=="string"?S(t):l(n)?(t._a=n.slice(0),b(t)):t._d=n instanceof Date?new Date(+n):new Date(n)}function T(e,t,n,r,i){return i.relativeTime(t||1,!!n,e,r)}function N(e,t,n){var r=D(Math.abs(e)/1e3),i=D(r/60),s=D(i/60),o=D(s/24),u=D(o/365),a=r<45&&["s",r]||i===1&&["m"]||i<45&&["mm",i]||s===1&&["h"]||s<22&&["hh",s]||o===1&&["d"]||o<=25&&["dd",o]||o<=45&&["M"]||o<345&&["MM",D(o/30)]||u===1&&["y"]||["yy",u];return a[2]=t,a[3]=e>0,a[4]=n,T.apply({},a)}function C(e,t,n){var r=n-t,i=n-e.day();return i>r&&(i-=7),i<r-7&&(i+=7),Math.ceil(M(e).add("d",i).dayOfYear()/7)}function k(e){var t=e._i,n=e._f;return t===null||t===""?null:(typeof t=="string"&&(e._i=t=p().preparse(t)),M.isMoment(t)?(e=o({},t),e._d=new Date(+t._d)):n?l(n)?E(e):w(e):x(e),new i(e))}function L(e,t){M.fn[e]=M.fn[e+"s"]=function(e){var n=this._isUTC?"UTC":"";return e!=null?(this._d["set"+n+t](e),this):this._d["get"+n+t]()}}function A(e){M.duration.fn[e]=function(){return this._data[e]}}function O(e,t){M.duration.fn["as"+e]=function(){return+this/t}}var M,_="2.0.0",D=Math.round,P,H={},B=typeof module!="undefined"&&module.exports,j=/^\/?Date\((\-?\d+)/i,F=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|a|A|hh?|HH?|mm?|ss?|SS?S?|X|zz?|ZZ?|.)/g,I=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,q=/([0-9a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)/gi,R=/\d\d?/,U=/\d{1,3}/,z=/\d{3}/,W=/\d{1,4}/,X=/[+\-]?\d{1,6}/,V=/[0-9]*[a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF]+\s*?[\u0600-\u06FF]+/i,$=/Z|[\+\-]\d\d:?\d\d/i,J=/T/i,K=/[\+\-]?\d+(\.\d{1,3})?/,Q=/^\s*\d{4}-\d\d-\d\d((T| )(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,G="YYYY-MM-DDTHH:mm:ssZ",Y=[["HH:mm:ss.S",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],Z=/([\+\-]|\d\d)/gi,et="Month|Date|Hours|Minutes|Seconds|Milliseconds".split("|"),tt={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},nt={},rt="DDD w W M D d".split(" "),it="M D H h m s w W".split(" "),st={M:function(){return this.month()+1},MMM:function(e){return this.lang().monthsShort(this,e)},MMMM:function(e){return this.lang().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.lang().weekdaysMin(this,e)},ddd:function(e){return this.lang().weekdaysShort(this,e)},dddd:function(e){return this.lang().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return a(this.year()%100,2)},YYYY:function(){return a(this.year(),4)},YYYYY:function(){return a(this.year(),5)},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return~~(this.milliseconds()/100)},SS:function(){return a(~~(this.milliseconds()/10),2)},SSS:function(){return a(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+a(~~(e/60),2)+":"+a(~~e%60,2)},ZZ:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+a(~~(10*e/6),4)},X:function(){return this.unix()}};while(rt.length)P=rt.pop(),st[P+"o"]=n(st[P]);while(it.length)P=it.pop(),st[P+P]=t(st[P],2);st.DDDD=t(st.DDD,3),r.prototype={set:function(e){var t,n;for(n in e)t=e[n],typeof t=="function"?this[n]=t:this["_"+n]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e){var t,n,r,i;this._monthsParse||(this._monthsParse=[]);for(t=0;t<12;t++){this._monthsParse[t]||(n=M([2e3,t]),r="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[t]=new RegExp(r.replace(".",""),"i"));if(this._monthsParse[t].test(e))return t}},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},meridiem:function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[last] dddd [at] LT",sameElse:"L"},calendar:function(e,t){var n=this._calendar[e];return typeof n=="function"?n.apply(t):n},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,n,r){var i=this._relativeTime[n];return typeof i=="function"?i(e,t,n,r):i.replace(/%d/i,e)},pastFuture:function(e,t){var n=this._relativeTime[e>0?"future":"past"];return typeof n=="function"?n(t):n.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",preparse:function(e){return e},postformat:function(e){return e},week:function(e){return C(e,this._week.dow,this._week.doy)},_week:{dow:0,doy:6}},M=function(e,t,n){return k({_i:e,_f:t,_l:n,_isUTC:!1})},M.utc=function(e,t,n){return k({_useUTC:!0,_isUTC:!0,_l:n,_i:e,_f:t})},M.unix=function(e){return M(e*1e3)},M.duration=function(e,t){var n=M.isDuration(e),r=typeof e=="number",i=n?e._data:r?{}:e,o;return r&&(t?i[t]=e:i.milliseconds=e),o=new s(i),n&&e.hasOwnProperty("_lang")&&(o._lang=e._lang),o},M.version=_,M.defaultFormat=G,M.lang=function(e,t){var n;if(!e)return M.fn._lang._abbr;t?h(e,t):H[e]||p(e),M.duration.fn._lang=M.fn._lang=p(e)},M.langData=function(e){return e&&e._lang&&e._lang._abbr&&(e=e._lang._abbr),p(e)},M.isMoment=function(e){return e instanceof i},M.isDuration=function(e){return e instanceof s},M.fn=i.prototype={clone:function(){return M(this)},valueOf:function(){return+this._d},unix:function(){return Math.floor(+this._d/1e3)},toString:function(){return this.format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._d},toJSON:function(){return M.utc(this).format("YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return this._isValid==null&&(this._a?this._isValid=!c(this._a,(this._isUTC?M.utc(this._a):M(this._a)).toArray()):this._isValid=!isNaN(this._d.getTime())),!!this._isValid},utc:function(){return this._isUTC=!0,this},local:function(){return this._isUTC=!1,this},format:function(e){var t=m(this,e||M.defaultFormat);return this.lang().postformat(t)},add:function(e,t){var n;return typeof e=="string"?n=M.duration(+t,e):n=M.duration(e,t),f(this,n,1),this},subtract:function(e,t){var n;return typeof e=="string"?n=M.duration(+t,e):n=M.duration(e,t),f(this,n,-1),this},diff:function(e,t,n){var r=this._isUTC?M(e).utc():M(e).local(),i=(this.zone()-r.zone())*6e4,s,o;return t&&(t=t.replace(/s$/,"")),t==="year"||t==="month"?(s=(this.daysInMonth()+r.daysInMonth())*432e5,o=(this.year()-r.year())*12+(this.month()-r.month()),o+=(this-M(this).startOf("month")-(r-M(r).startOf("month")))/s,t==="year"&&(o/=12)):(s=this-r-i,o=t==="second"?s/1e3:t==="minute"?s/6e4:t==="hour"?s/36e5:t==="day"?s/864e5:t==="week"?s/6048e5:s),n?o:u(o)},from:function(e,t){return M.duration(this.diff(e)).lang(this.lang()._abbr).humanize(!t)},fromNow:function(e){return this.from(M(),e)},calendar:function(){var e=this.diff(M().startOf("day"),"days",!0),t=e<-6?"sameElse":e<-1?"lastWeek":e<0?"lastDay":e<1?"sameDay":e<2?"nextDay":e<7?"nextWeek":"sameElse";return this.format(this.lang().calendar(t,this))},isLeapYear:function(){var e=this.year();return e%4===0&&e%100!==0||e%400===0},isDST:function(){return this.zone()<M([this.year()]).zone()||this.zone()<M([this.year(),5]).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e==null?t:this.add({d:e-t})},startOf:function(e){e=e.replace(/s$/,"");switch(e){case"year":this.month(0);case"month":this.date(1);case"week":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return e==="week"&&this.day(0),this},endOf:function(e){return this.startOf(e).add(e.replace(/s?$/,"s"),1).subtract("ms",1)},isAfter:function(e,t){return t=typeof t!="undefined"?t:"millisecond",+this.clone().startOf(t)>+M(e).startOf(t)},isBefore:function(e,t){return t=typeof t!="undefined"?t:"millisecond",+this.clone().startOf(t)<+M(e).startOf(t)},isSame:function(e,t){return t=typeof t!="undefined"?t:"millisecond",+this.clone().startOf(t)===+M(e).startOf(t)},zone:function(){return this._isUTC?0:this._d.getTimezoneOffset()},daysInMonth:function(){return M.utc([this.year(),this.month()+1,0]).date()},dayOfYear:function(e){var t=D((M(this).startOf("day")-M(this).startOf("year"))/864e5)+1;return e==null?t:this.add("d",e-t)},isoWeek:function(e){var t=C(this,1,4);return e==null?t:this.add("d",(e-t)*7)},week:function(e){var t=this.lang().week(this);return e==null?t:this.add("d",(e-t)*7)},lang:function(t){return t===e?this._lang:(this._lang=p(t),this)}};for(P=0;P<et.length;P++)L(et[P].toLowerCase().replace(/s$/,""),et[P]);L("year","FullYear"),M.fn.days=M.fn.day,M.fn.weeks=M.fn.week,M.fn.isoWeeks=M.fn.isoWeek,M.duration.fn=s.prototype={weeks:function(){return u(this.days()/7)},valueOf:function(){return this._milliseconds+this._days*864e5+this._months*2592e6},humanize:function(e){var t=+this,n=N(t,!e,this.lang());return e&&(n=this.lang().pastFuture(t,n)),this.lang().postformat(n)},lang:M.fn.lang};for(P in tt)tt.hasOwnProperty(P)&&(O(P,tt[P]),A(P.toLowerCase()));O("Weeks",6048e5),M.lang("en",{ordinal:function(e){var t=e%10,n=~~(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+n}}),B&&(module.exports=M),typeof ender=="undefined"&&(this.moment=M),typeof define=="function"&&define.amd&&define("moment",[],function(){return M})}.call(this),moment}),define("dataCache",["moment"],function(e){var t="dataCache",n={},r=function(){return n},i=function(e){var t=[];for(var n=0;n<e.length;n++)t.push({locationID:e[n].i,lat:e[n].la,lng:e[n].lg,n:e[n].n});return t},s=function(t){var n={};for(var r=0;r<t.length;r++){var i=t[r].locID;n.hasOwnProperty(i)||(n[i]={locationID:i,lat:t[r].lat,lng:t[r].lng,n:t[r].locName,sightings:[]}),n[i].sightings.push({comName:t[r].comName,sciName:t[r].sciName,obsDt_unixtime:e(t[r].obsDt,"YYYY-MM-DD HH:mm").unix(),obsDt:e(t[r].obsDt,"YYYY-MM-DD HH:mm").format("MMM Do, h:mm a"),obsReviewed:t[r].obsReviewed,obsValid:t[r].obsValid,howMany:t[r].howMany})}var s=[];for(var o in n)s.push(n[o]);return s},o=function(t){var n={};for(var r=0;r<t.length;r++){var i=t[r].locID;n.hasOwnProperty(i)||(n[i]={locationID:i,lat:t[r].lat,lng:t[r].lng,n:t[r].locName,sightings:[]}),n[i].sightings.push({comName:t[r].comName,sciName:t[r].sciName,obsDt_unixtime:e(t[r].obsDt,"YYYY-MM-DD HH:mm").unix(),obsDt:e(t[r].obsDt,"YYYY-MM-DD HH:mm").format("MMM Do, h:mm a"),obsReviewed:t[r].obsReviewed,obsValid:t[r].obsValid,howMany:t[r].howMany,reporterName:t[r].firstName+" "+t[r].lastName})}var s=[];for(var o in n)s.push(n[o]);return s};return{getHotspots:r,formatHotspotData:i,formatNotableSightingsData:o,formatBirdSightingsData:s}}),define("underscore",[],function(){return!function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=i.toString,l=i.hasOwnProperty,c=r.forEach,h=r.map,p=r.reduce,d=r.reduceRight,v=r.filter,m=r.every,g=r.some,y=r.indexOf,b=r.lastIndexOf,w=Array.isArray,E=Object.keys,S=s.bind,x=function(e){return e instanceof x?e:this instanceof x?(this._wrapped=e,void 0):new x(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.5.0";var T=x.each=x.forEach=function(e,t,r){if(null!=e)if(c&&e.forEach===c)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;s>i;i++)if(t.call(r,e[i],i,e)===n)return}else for(var o in e)if(x.has(e,o)&&t.call(r,e[o],o,e)===n)return};x.map=x.collect=function(e,t,n){var r=[];return null==e?r:h&&e.map===h?e.map(t,n):(T(e,function(e,i,s){r.push(t.call(n,e,i,s))}),r)};var N="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return r&&(t=x.bind(t,r)),i?e.reduce(t,n):e.reduce(t);if(T(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)}),!i)throw new TypeError(N);return n},x.reduceRight=x.foldr=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),d&&e.reduceRight===d)return r&&(t=x.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=x.keys(e);s=o.length}if(T(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)}),!i)throw new TypeError(N);return n},x.find=x.detect=function(e,t,n){var r;return C(e,function(e,i,s){return t.call(n,e,i,s)?(r=e,!0):void 0}),r},x.filter=x.select=function(e,t,n){var r=[];return null==e?r:v&&e.filter===v?e.filter(t,n):(T(e,function(e,i,s){t.call(n,e,i,s)&&r.push(e)}),r)},x.reject=function(e,t,n){return x.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},x.every=x.all=function(e,t,r){t||(t=x.identity);var i=!0;return null==e?i:m&&e.every===m?e.every(t,r):(T(e,function(e,s,o){return(i=i&&t.call(r,e,s,o))?void 0:n}),!!i)};var C=x.some=x.any=function(e,t,r){t||(t=x.identity);var i=!1;return null==e?i:g&&e.some===g?e.some(t,r):(T(e,function(e,s,o){return i||(i=t.call(r,e,s,o))?n:void 0}),!!i)};x.contains=x.include=function(e,t){return null==e?!1:y&&e.indexOf===y?e.indexOf(t)!=-1:C(e,function(e){return e===t})},x.invoke=function(e,t){var n=u.call(arguments,2),r=x.isFunction(t);return x.map(e,function(e){return(r?t:e[t]).apply(e,n)})},x.pluck=function(e,t){return x.map(e,function(e){return e[t]})},x.where=function(e,t,n){return x.isEmpty(t)?n?void 0:[]:x[n?"find":"filter"](e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},x.findWhere=function(e,t){return x.where(e,t,!0)},x.max=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&x.isEmpty(e))return-1/0;var r={computed:-1/0,value:-1/0};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>r.computed&&(r={value:e,computed:o})}),r.value},x.min=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&x.isEmpty(e))return 1/0;var r={computed:1/0,value:1/0};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o<r.computed&&(r={value:e,computed:o})}),r.value},x.shuffle=function(e){var t,n=0,r=[];return T(e,function(e){t=x.random(n++),r[n-1]=r[t],r[t]=e}),r};var k=function(e){return x.isFunction(e)?e:function(t){return t[e]}};x.sortBy=function(e,t,n){var r=k(t);return x.pluck(x.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(r>n||r===void 0)return-1}return e.index<t.index?-1:1}),"value")};var L=function(e,t,n,r){var i={},s=k(null==t?x.identity:t);return T(e,function(t,o){var u=s.call(n,t,o,e);r(i,u,t)}),i};x.groupBy=function(e,t,n){return L(e,t,n,function(e,t,n){(x.has(e,t)?e[t]:e[t]=[]).push(n)})},x.countBy=function(e,t,n){return L(e,t,n,function(e,t){x.has(e,t)||(e[t]=0),e[t]++})},x.sortedIndex=function(e,t,n,r){n=null==n?x.identity:k(n);for(var i=n.call(r,t),s=0,o=e.length;o>s;){var u=s+o>>>1;n.call(r,e[u])<i?s=u+1:o=u}return s},x.toArray=function(e){return e?x.isArray(e)?u.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return null==e?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:u.call(e,0,t)},x.initial=function(e,t,n){return u.call(e,0,e.length-(null==t||n?1:t))},x.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:u.call(e,Math.max(e.length-t,0))},x.rest=x.tail=x.drop=function(e,t,n){return u.call(e,null==t||n?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var A=function(e,t,n){return t&&x.every(e,x.isArray)?a.apply(n,e):(T(e,function(e){x.isArray(e)||x.isArguments(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n)};x.flatten=function(e,t){return A(e,t,[])},x.without=function(e){return x.difference(e,u.call(arguments,1))},x.uniq=x.unique=function(e,t,n,r){x.isFunction(t)&&(r=n,n=t,t=!1);var i=n?x.map(e,n,r):e,s=[],o=[];return T(i,function(n,r){(t?r&&o[o.length-1]===n:x.contains(o,n))||(o.push(n),s.push(e[r]))}),s},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(e){var t=u.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.indexOf(t,e)>=0})})},x.difference=function(e){var t=a.apply(r,u.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){return x.unzip.apply(x,u.call(arguments))},x.unzip=function(){for(var e=x.max(x.pluck(arguments,"length").concat(0)),t=new Array(e),n=0;e>n;n++)t[n]=x.pluck(arguments,""+n);return t},x.object=function(e,t){if(null==e)return{};for(var n={},r=0,i=e.length;i>r;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},x.indexOf=function(e,t,n){if(null==e)return-1;var r=0,i=e.length;if(n){if("number"!=typeof n)return r=x.sortedIndex(e,t),e[r]===t?r:-1;r=0>n?Math.max(0,i+n):n}if(y&&e.indexOf===y)return e.indexOf(t,n);for(;i>r;r++)if(e[r]===t)return r;return-1},x.lastIndexOf=function(e,t,n){if(null==e)return-1;var r=null!=n;if(b&&e.lastIndexOf===b)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var i=r?n:e.length;i--;)if(e[i]===t)return i;return-1},x.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;for(var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);r>i;)s[i++]=e,e+=n;return s};var O=function(){};x.bind=function(e,t){var n,r;if(S&&e.bind===S)return S.apply(e,u.call(arguments,1));if(!x.isFunction(e))throw new TypeError;return n=u.call(arguments,2),r=function(){if(this instanceof r){O.prototype=e.prototype;var i=new O;O.prototype=null;var s=e.apply(i,n.concat(u.call(arguments)));return Object(s)===s?s:i}return e.apply(t,n.concat(u.call(arguments)))}},x.partial=function(e){var t=u.call(arguments,1);return function(){return e.apply(this,t.concat(u.call(arguments)))}},x.bindAll=function(e){var t=u.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return T(t,function(t){e[t]=x.bind(e[t],e)}),e},x.memoize=function(e,t){var n={};return t||(t=x.identity),function(){var r=t.apply(this,arguments);return x.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},x.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(u.call(arguments,1)))},x.throttle=function(e,t,n){var r,i,s,o=null,u=0;n||(n={});var a=function(){u=new Date,o=null,s=e.apply(r,i)};return function(){var f=new Date;u||n.leading!==!1||(u=f);var l=t-(f-u);return r=this,i=arguments,0>=l?(clearTimeout(o),o=null,u=f,s=e.apply(r,i)):o||n.trailing===!1||(o=setTimeout(a,l)),s}},x.debounce=function(e,t,n){var r,i=null;return function(){var s=this,o=arguments,u=function(){i=null,n||(r=e.apply(s,o))},a=n&&!i;return clearTimeout(i),i=setTimeout(u,t),a&&(r=e.apply(s,o)),r}},x.once=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}},x.wrap=function(e,t){return function(){var n=[e];return o.apply(n,arguments),t.apply(this,n)}},x.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},x.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},x.keys=E||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)x.has(e,n)&&t.push(n);return t},x.values=function(e){var t=[];for(var n in e)x.has(e,n)&&t.push(e[n]);return t},x.pairs=function(e){var t=[];for(var n in e)x.has(e,n)&&t.push([n,e[n]]);return t},x.invert=function(e){var t={};for(var n in e)x.has(e,n)&&(t[e[n]]=n);return t},x.functions=x.methods=function(e){var t=[];for(var n in e)x.isFunction(e[n])&&t.push(n);return t.sort()},x.extend=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},x.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return T(n,function(n){n in e&&(t[n]=e[n])}),t},x.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)x.contains(n,i)||(t[i]=e[i]);return t},x.defaults=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]===void 0&&(e[n]=t[n])}),e},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var M=function(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var i=f.call(e);if(i!=f.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var s=n.length;s--;)if(n[s]==e)return r[s]==t;var o=e.constructor,u=t.constructor;if(o!==u&&!(x.isFunction(o)&&o instanceof o&&x.isFunction(u)&&u instanceof u))return!1;n.push(e),r.push(t);var a=0,l=!0;if("[object Array]"==i){if(a=e.length,l=a==t.length)for(;a--&&(l=M(e[a],t[a],n,r)););}else{for(var c in e)if(x.has(e,c)&&(a++,!(l=x.has(t,c)&&M(e[c],t[c],n,r))))break;if(l){for(c in t)if(x.has(t,c)&&!(a--))break;l=!a}}return n.pop(),r.pop(),l};x.isEqual=function(e,t){return M(e,t,[],[])},x.isEmpty=function(e){if(null==e)return!0;if(x.isArray(e)||x.isString(e))return 0===e.length;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!!e&&1===e.nodeType},x.isArray=w||function(e){return"[object Array]"==f.call(e)},x.isObject=function(e){return e===Object(e)},T(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return f.call(t)=="[object "+e+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!!e&&!!x.has(e,"callee")}),"function"!=typeof /./&&(x.isFunction=function(e){return"function"==typeof e}),x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==f.call(e)},x.isNull=function(e){return null===e},x.isUndefined=function(e){return e===void 0},x.has=function(e,t){return l.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.times=function(e,t,n){for(var r=Array(Math.max(0,e)),i=0;e>i;i++)r[i]=t.call(n,i);return r},x.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var _={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};_.unescape=x.invert(_.escape);var D={escape:new RegExp("["+x.keys(_.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(_.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){return null==t?"":(""+t).replace(D[e],function(t){return _[e][t]})}}),x.result=function(e,t){if(null==e)return void 0;var n=e[t];return x.isFunction(n)?n.call(e):n},x.mixin=function(e){T(x.functions(e),function(t){var n=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),F.call(this,n.apply(x,e))}})};var P=0;x.uniqueId=function(e){var t=++P+"";return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,n){var r;n=x.defaults({},n,x.templateSettings);var i=new RegExp([(n.escape||H).source,(n.interpolate||H).source,(n.evaluate||H).source].join("|")+"|$","g"),s=0,o="__p+='";e.replace(i,function(t,n,r,i,u){return o+=e.slice(s,u).replace(j,function(e){return"\\"+B[e]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(o+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(o+="';\n"+i+"\n__p+='"),s=u+t.length,t}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{r=new Function(n.variable||"obj","_",o)}catch(u){throw u.source=o,u}if(t)return r(t,x);var a=function(e){return r.call(this,e,x)};return a.source="function("+(n.variable||"obj")+"){\n"+o+"}",a},x.chain=function(e){return x(e).chain()};var F=function(e){return this._chain?x(e).chain():e};x.mixin(x),T(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];x.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!=e&&"splice"!=e||0!==n.length||delete n[0],F.call(this,n)}}),T(["concat","join","slice"],function(e){var t=r[e];x.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),_}),define("moduleHelper",["mediator"],function(e){var t="moduleHelper",n=null,r=function(){},i=function(){if(n!==null)return;n=Spinners.create($("#loadingSpinner")[0],{radius:5,height:7,width:1.5,dashes:14,opacity:1,padding:0,rotation:1400,fadeOutSpeed:0,color:"#efefef",pauseColor:"#444444",pauseOpacity:1}).pause()},s=function(e,t){var n=$("#messageBar");n.hasClass("visible")?n.removeClass().addClass(t+" visible").html(e):n.css("display","none").removeClass().addClass(t+" visible").html(e).fadeIn(300)},o=function(){n.play()},u=function(){n.pause()},a=function(){var e=function(e){if(e=="")return{};var t={};for(var n=0;n<e.length;++n){var r=e[n].split("=");if(r.length!=2)continue;t[r[0]]=decodeURIComponent(r[1].replace(/\+/g," "))}return t}(window.location.search.substr(1).split("&"));return e},f=function(){var e=a();return e.hasOwnProperty("lang")?"lang_"+e.lang:"lang_en"};return e.register(t,{init:r}),{getCurrentLangFile:f,getQueryStringParams:a,initSpinner:i,showMessage:s,startLoading:o,stopLoading:u}}),define("text",["module"],function(e){var t,n,r,i,s=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],o=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,u=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,a=typeof location!="undefined"&&location.href,f=a&&location.protocol&&location.protocol.replace(/\:/,""),l=a&&location.hostname,c=a&&(location.port||undefined),h={},p=e.config&&e.config()||{};t={version:"2.0.7",strip:function(e){if(e){e=e.replace(o,"");var t=e.match(u);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:p.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=s[t];try{e=new ActiveXObject(n)}catch(r){}if(e){s=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,p.isBuild&&(h[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}p.isBuild=i.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=n.toUrl(o),h=p.useXhr||t.useXhr;!a||h(u,f,l,c)?t.get(u,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(h.hasOwnProperty(n)){var s=t.jsEscape(h[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(p.env==="node"||!p.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node)n=require.nodeRequire("fs"),t.get=function(e,t,r){try{var i=n.readFileSync(e,"utf8");i.indexOf("﻿")===0&&(i=i.substring(1)),t(i)}catch(s){r(s)}};else if(p.env==="xhr"||!p.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);p.onXhr&&p.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r(o)):n(s.responseText),p.onXhrComplete&&p.onXhrComplete(s,e))},s.send(null)};else if(p.env==="rhino"||!p.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),r!==null&&n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(p.env==="xpconnect"||!p.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),t.get=function(e,t){var n,s,o={},u=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(u,1,0,!1),s=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),s.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),s.readString(n.available(),o),s.close(),n.close(),t(o.value)}catch(a){throw new Error((u&&u.path||"")+": "+a)}};return t}),define("text!headerTemplate",[],function(){return'<div class="navbar">\n	<div class="navbar-inner">\n		<div class="container">\n			<span class="brand">bird<span>search</span>.org</span>\n			<div class="nav-collapse">\n				<ul class="nav pull-right">\n					<li class="divider-vertical"></li>\n					<li><a href="#aboutDialog" data-toggle="modal"><%=L.about%></a></li>\n					<li class="divider-vertical"></li>\n					<li><a href="http://ebird.org">eBird.org</a></li>\n					<li class="divider-vertical"></li>\n					<li>\n						<select id="lang">\n							<option value="en"<% if (currentLangFile === "lang_en"){%> selected="selected"<% } %>>English</option>\n							<option value="fr"<% if (currentLangFile === "lang_fr"){%> selected="selected"<% } %>>Français</option>\n							<option value="de"<% if (currentLangFile === "lang_de"){%> selected="selected"<% } %>>Deutsch</option>\n							<option value="es"<% if (currentLangFile === "lang_es"){%> selected="selected"<% } %>>Español</option>\n						</select>\n					</li>\n				</ul>\n			</div>\n		</div>\n	</div>\n</div>\n'}),define("header",["mediator","constants","underscore","moduleHelper","text!headerTemplate"],function(e,t,n,r,i){var s="header",o={},u=function(){var e=r.getCurrentLangFile();require([e],function(t){o=t;var r=n.template(i,{L:o,currentLangFile:e});$("header").html(r),a()})},a=function(){$("#aboutLink").on("click",function(n){n.preventDefault(),e.publish(s,t.EVENT.ABOUT_LINK_CLICK)}),$("#lang").on("change",function(e){window.location="?lang="+$(e.target).val()})};e.register(s,{run:u})}),define("text!sidebarTemplate",[],function(){return'<div id="backLeft"><div></div></div>\n\n<div id="searchPanel" class="well well-pad">\n	<input type="text" id="location" placeholder="<%= L.please_enter_location_search_default %> "/>\n\n	<ul id="resultTypeGroup">\n		<li class="selected">\n			<input type="radio" name="resultType" id="rt1" value="all" checked="checked" />\n			<label for="rt1"><%= L.bird_sightings %></label>\n		</li>\n		<li>\n			<input type="radio" name="resultType" id="rt2" value="notable" />\n			<label for="rt2"><%= L.notable_sightings %></label>\n		</li>\n		<li>\n			<input type="radio" name="resultType" id="rt3" value="hotspots" />\n			<label for="rt3"><%= L.popular_birding_locations %></label>\n		</li>\n	</ul>\n\n	<a href="#" id="searchOptionsLink"><%= L.more_search_options %></a>\n\n	<!-- optional search options for the "All bird sightings" and "Notable sightings" search option -->\n	<div id="observationRecencySection" style="display:none">\n		<label for="observationRecency">\n			<%=L.show_obs_made_within_last%> <span id="observationRecencyDisplay">7</span> <%=L.day_or_days%>\n		</label>\n		<ol class="rangeTip">\n			<li class="rangeTipLeft">1</li>\n			<li>\n				<input type="range" id="observationRecency" min="1" max="30" value="7" />\n			</li>\n			<li class="rangeTipRight">30</li>\n		</ol>\n		<div class="clear"></div>\n	</div>\n\n	<!-- optional search options for the "Popular birding locations" search option -->\n	<div id="hotspotActivitySection" style="display:none">\n		<input type="checkbox" id="limitHotspotsByObservationRecency" />\n		<label for="limitHotspotsByObservationRecency">\n			<%=L.limit_to_locations%> <span id="hotspotActivityRecencyDisplay">7</span> <%=L.day_or_days%>\n		</label>\n		<ol class="rangeTip">\n			<li class="rangeTipLeft">1</li>\n			<li>\n				<input type="range" id="hotspotActivity" min="1" max="30" value="7" />\n			</li>\n			<li class="rangeTipRight">30</li>\n		</ol>\n	</div>\n\n	<div style="margin-top: 10px;">\n		<input type="submit" class="btn btn-primary" id="searchBtn" value="<%=L.search%> &raquo;" />\n		<span id="loadingSpinner"></span>\n	</div>\n</div>\n\n<div id="messageBar"></div>\n\n<div id="sidebarResults" style="height:<%=resultsPanelHeight%>px" class="sidebarSection hidden"></div>\n'}),define("text!sidebarResultsTable",[],function(){return'<table class="tablesorter tablesorter-bootstrap table table-striped" id="sidebarResultsTable">\n	<thead>\n	<tr>\n		<th><%=L.location.toUpperCase()%></th>\n		<% if (showSpeciesColumn) { %><th width="40" class="sorter-species" style="text-align:right"><%=L.count.toUpperCase()%></th><% } %>\n	</tr>\n	</thead>\n	<tbody>\n	<% _.each(hotspots, function(hotspot, index) { %>\n		<tr id="location_<%=hotspot.locationID%>" class="<%=hotspot.rowClass%>">\n			<td class="loadingStatus"><label><%=hotspot.n%></label></td>\n			<% if (showSpeciesColumn) { %>\n			<td class="sp">\n				<% if (asyncLoading) { %>\n					<div id="spinner_<%=hotspot.locationID%>" class="speciesCount"><%=hotspot.numSpeciesWithinRange%></div>\n				<% } else { %>\n					<div class="speciesCount"><%=hotspot.sightings.length%></div>\n				<% } %>\n			</td>\n			<% } %>\n		</tr>\n	<% }); %>\n	</tbody>\n</table>\n'}),define("sidebar",["mediator","constants","moduleHelper","text!sidebarTemplate","text!sidebarResultsTable"],function(e,t,n,r,i){var s="sidebar",o,u,a,f=null,l="all",c=!1,h=null,p=null,d=[],v,m,g,y,b,w,E,S,x,T,N,C,k,L,A={},O=[],M=null,D={},P=null,H=86400,B=function(){P=parseInt($("body").data("serverdatetime"),10);var i={};i[t.EVENT.WINDOW_RESIZE]=Z,i[t.EVENT.MAP.BIRD_MARKERS_ADDED]=X,i[t.EVENT.MAP.NOTABLE_MARKERS_ADDED]=V,i[t.EVENT.MAP.HOTSPOT_MARKERS_ADDED]=J,e.subscribe(s,i),require([n.getCurrentLangFile()],function(e){D=e;var i=_.template(r,{L:D,resultsPanelHeight:0});$("#sidebar").html(i),u=new google.maps.Geocoder,v=$("#location"),m=$("#resultTypeGroup"),g=$("input[name=resultType]"),y=$("#searchOptionsLink"),b=$("#observationRecencySection"),w=$("#observationRecency"),E=$("#observationRecencyDisplay"),S=$("#hotspotActivitySection"),T=$("#limitHotspotsByObservationRecency"),x=$("#hotspotActivityRecencyDisplay"),N=$("#hotspotActivity"),C=$("#searchBtn"),j(),F(),n.initSpinner(),v.focus();for(var s=0;s<t.SETTINGS.NUM_SEARCH_DAYS;s++)d.push({available:!1,obs:[],numSpecies:0,numSpeciesRunningTotal:0})})},j=function(){o=new google.maps.places.Autocomplete(v[0]),google.maps.event.addListener(o,"place_changed",I),$(v[0]).on("keydown",function(e){e.keyCode==13&&e.preventDefault()}),C.on("click",G),w.on("change",q),N.on("change",R),m.on("change","li",U),y.on("click",z);var e=$("#sidebarResults");e.on("mouseover","#sidebarResultsTable tbody tr",nt),e.on("mouseout","#sidebarResultsTable tbody tr",rt),e.on("click","#sidebarResultsTable tbody tr",it)},F=function(){Modernizr.inputtypes.range||$("input[type=range]").each(function(){if($(this).nextAll(".slider").length)return;var e=$(this),t=$(this).attr("id"),n=$('<div class="slider" />');n.width(e.width()),e.after(n.slider({min:parseFloat(e.attr("min")),max:parseFloat(e.attr("max")),value:parseFloat(e.val()),step:parseFloat(e.attr("step")),slide:function(n,r){e.val(r.value),t==="observationRecency"?E.html(r.value):t==="hotspotActivity"&&(x.html(r.value),T.prop("checked",!0))},change:function(n,r){e.val(r.value),t==="observationRecency"?E.html(r.value):t==="hotspotActivity"&&(x.html(r.value),T.prop("checked",!0))}}))}).hide()},I=function(){var e=o.getPlace();if(!e.geometry)return;L=e.geometry.hasOwnProperty("viewport")?e.geometry.viewport:null,k=e.geometry.location,a=null,v[0].value!==""&&e!==null&&(a=e.address_components.length)},q=function(e){E.html(e.target.value)},R=function(e){x.html(e.target.value),T.prop("checked",!0)},U=function(n){n.stopImmediatePropagation();var r=n.currentTarget,i=$(r).find("input").val();if(i===l)return;var o=$("#resultTypeGroup li");for(var u=0;u<o.length;u++)$(o[u]).removeClass("selected");$(r).addClass("selected").find("input").attr("checked","checked"),c&&((l==="all"||l==="notable")&&$("#observationRecencySection").hide(),l==="hotspots"&&$("#hotspotActivitySection").hide(),(i==="all"||i==="notable")&&$("#observationRecencySection").show(),i==="hotspots"&&$("#hotspotActivitySection").show()),e.publish(s,t.EVENT.SEARCH_TYPE_CHANGED,{oldSearchType:l,newSearchType:i}),l=i},z=function(e){e.preventDefault();var t=tt();t==="all"||t==="notable"?c?($("#sidebarResults").css({height:et()+40}),$("#observationRecencySection").hide("blind",W)):$("#observationRecencySection").show("blind",W):t==="hotspots"&&(c?($("#sidebarResults").css({height:et()+40}),$("#hotspotActivitySection").hide("blind",W)):$("#hotspotActivitySection").show("blind",W)),c?y.html(D.more_search_options):y.html(D.hide_search_options),c=!c},W=function(){$("#sidebarResults").css({height:et()})},X=function(e){O=e.data.locations;if($.isArray(O)&&O.length>0){for(var t=0;t<O.length;t++){var r=O[t].locationID;A.hasOwnProperty(r)||(A[r]=O[t])}var i="locations";O.length===1&&(i="location");var s="<b>"+O.length+"</b> "+i;n.showMessage(s,"notification"),M=O.length,Q()}else n.showMessage(D.no_results_found,"notification"),$("#sidebarResults").fadeOut(300),n.stopLoading()},V=function(e){var t=e.data.locations,r=t.length,i="location";if(r===0||r>1)i="locations";var s=0;for(var o=0;o<r;o++)s+=t[o].sightings.length;var u="sighting";if(r===0||r>1)u="sightings";var a="<b>"+r+"</b> "+i+", "+"<b>"+s+"</b> "+u;n.showMessage(a,"notification"),K(t,{showSpeciesColumn:!0})},J=function(e){var t=e.data.hotspots.length,r="location";if(t==0||t>1)r="locations";n.showMessage("<b>"+t+"</b> "+r+" found","notification"),K(e.data.hotspots)},K=function(e,t){var n=$.extend({showCheckboxColumn:!1,showSpeciesColumn:!1},t);if(e.length>0){var r=_.template(i,{showCheckboxColumn:n.showCheckboxColumn,showSpeciesColumn:n.showSpeciesColumn,hotspots:e,asyncLoading:!1,L:D});$("#sidebarResults").html(r).removeClass("hidden").css({height:et()}).fadeIn(300),ht("#sidebarResultsTable")}else $("#sidebarResults").addClass("hidden")},Q=function(e){var t=[];for(var n=0;n<M;n++){var r=O[n],s=O[n].locationID;r.rowClass="",r.numSpeciesWithinRange="",!A[s].hasOwnProperty("sightings")||!A[s].sightings.data[f-1].available?r.rowClass="notLoaded":r.numSpeciesWithinRange=A[s].sightings.data[f-1].numSpeciesRunningTotal,t.push(r)}var o=_.template(i,{L:D,asyncLoading:!0,showSpeciesColumn:!0,hotspots:t});$("#sidebarResults").html(o).removeClass("hidden").css({height:et()}).fadeIn(300);var u=$(".notLoaded .speciesCount");for(var n=0;n<u.length;n++)Spinners.create($(u[n])[0],{radius:3,height:4,width:1.4,dashes:12,opacity:1,padding:0,rotation:1400,fadeOutSpeed:0,color:"#222222"}).play();st()},G=function(r){r.preventDefault();if(Y()){n.startLoading();var i=tt();i==="all"||i==="notable"?f=w.val():f=N.val(),e.publish(s,t.EVENT.INIT_SEARCH,{location:v.val(),resultType:tt(),observationRecencyField:w.val(),viewportObj:L,locationObj:k,searchOptions:{allAndNotable:{observationRecency:w.val()},hotspots:{limitByObservationRecency:T.prop("checked"),observationRecency:N.val()}}})}},Y=function(){var e=v[0].value,t=tt();return e===""?(n.showMessage(D.please_enter_location,"error"),!1):!L&&!k?(n.showMessage(D.please_select_location_from_dropdown,"error"),!1):t==="all"&&a<3?(n.showMessage(D.please_enter_more_specific_location,"error"),!1):t=="hotspots"&&a<3?(n.showMessage(D.please_enter_more_specific_location,"error"),!1):t=="notable"&&a<2?(n.showMessage(D.please_enter_more_specific_location,"error"),!1):!0},Z=function(e){e.data.viewportMode==="desktop"?$("#sidebar").css("height",e.data.height-60):$("#sidebar").css("height","auto"),$("#hotspotTable").css({height:et})},et=function(){if(p===null){var e=$("header").height(),t=$("#messageBar").height(),n=50;p=e+t+n}var r=$("#searchPanel").height(),i=$(window).height();return i-(p+r)},tt=function(){return g.filter(":checked").val()},nt=function(n){var r=$(n.currentTarget).attr("id");r&&(h=r.replace(/^location_/,""),e.publish(s,t.EVENT.LOCATION_MOUSEOVER,{locationID:h}))},rt=function(){h!==null&&e.publish(s,t.EVENT.LOCATION_MOUSEOUT,{locationID:h}),h=null},it=function(){if(h===null)return;var n={locationID:h};l==="all"&&(n.numSpecies=A[h].sightings.data[f-1].numSpeciesRunningTotal),e.publish(s,t.EVENT.LOCATION_CLICK,n)},st=function(){var r=!1;for(var i=0;i<M;i++){var o=O[i].locationID;A[o].hasOwnProperty("sightings")||(A[o].isDisplayed=!1,A[o].sightings={success:null,data:$.extend(!0,[],d)}),A[o].sightings.data[f-1].available?lt(o,A[o].sightings.data[f-1].numSpeciesRunningTotal):(ot(o),r=!0)}if(!r){ht("#sidebarResultsTable"),n.stopLoading();var u=at();e.publish(s,t.EVENT.BIRD_SIGHTINGS_LOADED,{birdData:u,observationRecency:f})}},ot=function(e){$.ajax({url:"ajax/getHotspotSightings.php",data:{locationID:e,recency:f},type:"POST",dataType:"json",success:function(t){ut(e,t)},error:function(t){ft(e,t)}})},ut=function(r,i){A[r].isDisplayed=!0,A[r].sightings.success=!0;var o=A[r].sightings.data;for(var u=0;u<t.SETTINGS.NUM_SEARCH_DAYS;u++)u<=f?o[u]={available:!0,obs:[],numSpecies:0,numSpeciesRunningTotal:0}:o[u]={available:!1,obs:[],numSpecies:0,numSpeciesRunningTotal:0};var a=i.length;for(var u=0;u<a;u++){var l=parseInt(moment(i[u].obsDt,"YYYY-MM-DD HH:mm").format("X"),10),c=P-l,h=Math.ceil(c/H),h=h<1?1:h;o[h-1].obs.push(i[u])}for(var u=0;u<o.length;u++)o[u].numSpecies=o[u].obs.length;var p={},d=0;for(var u=0;u<t.SETTINGS.NUM_SEARCH_DAYS;u++){var v=A[r].sightings.data[u];for(var m=0;m<v.obs.length;m++)p.hasOwnProperty(v.obs[m].sciName)||(p[v.obs[m].sciName]=null,d++);A[r].sightings.data[u].numSpeciesRunningTotal=d}lt(r,i.length);if(ct()){ht("#sidebarResultsTable"),n.stopLoading();var g=at();e.publish(s,t.EVENT.BIRD_SIGHTINGS_LOADED,{birdData:g,observationRecency:f})}},at=function(){var e=[];for(var t=0;t<O.length;t++)e.push(O[t].locationID);var n={};for(var t=0;t<e.length;t++)n[e[t]]=A[e[t]];return n},ft=function(e,t){A[e].sightings.success=!1,ct()&&n.stopLoading()},lt=function(e,t){var n=D.num_species_seen_at_location.replace(/%1/,t);n=n.replace(/%2/,f);var r=$("#location_"+e);r.removeClass("notLoaded").addClass("loaded");var i=r.find(".speciesCount"),s=$(i).attr("id");Spinners.get("#"+s).remove(),t>0&&r.find(".speciesCount").html(t).attr("title",n)},ct=function(){var e=!0;for(var t=0;t<M;t++){var n=O[t].locationID;if(A[n].sightings.success===null){e=!1;break}}return e},ht=function(e){try{$(e).trigger("destroy")}catch(t){}$(e).tablesorter()};e.register(s,{init:B})}),define("text!mainPanelTemplate",[],function(){return'<div id="eBirdText"><%= eBirdText %></div>\n<ul id="panelTabs">\n	<li id="mapTab" class="btn btn-primary"><%=L.map%></li>\n	<li id="locationsTab" class="hidden"><%=L.locations%></li>\n	<li id="birdSpeciesTab" class="hidden"><%=L.bird_species%></li>\n</ul>\n<div id="panelContent">\n	<div id="mapTabContent"></div>\n	<div id="locationsTabContent" class="hidden"></div>\n	<div id="birdSpeciesTabContent" class="hidden">\n		<div id="birdSpeciesTable"></div>\n	</div>\n</div>'}),define("text!birdSightingsTableTemplate",[],function(){return'<div class="fixedHeader">\n	<div>\n		<h1>\n			<% if (isSingleLocation) { %>\n				<a href="#" class="showBirdSightingsTable"><%=L.sightings%></a>\n				<span class="joiner">&raquo;</span> <%= locationName %>\n			<% } else { %>\n				<%=L.sightings%>\n			<% } %>\n		</h1>\n		<h2><%= L.last %> <%= searchObservationRecency%> <% if (searchObservationRecency == 1) { %><%= L.day %><% } else { %><%= L.days %><% } %></h2>\n		<div class="clear"></div>\n	</div>\n</div>\n\n<div class="fixedContent">\n	<table class="birdSightingsTable table tablesorter table-striped table-hover" id="birdSightings">\n		<thead>\n			<th><%=L.species%></th>\n			<th><%=L.scientific_name%></th>\n			<th><%=L.locations_seen%> <a href="#" class="toggleBirdSpeciesLocations">(+)</a></th>\n			<th width="140"><%=L.last_seen%></th>\n			<th width="80"><%=L.num_reported%></th>\n		</thead>\n		<tbody>\n		<% _.each(sightings, function(sighting, index) { %>\n		<tr>\n			<td class="species"><%=sighting.comName%></td>\n			<td><%=sighting.sciName%></td>\n			<td>\n				<%= L.seen_at %> <%= sighting.obs.length %> <% if (sighting.obs.length > 1) {%><%= L.locations.toLowerCase() %><% } else { %><%= L.location.toLowerCase() %><% } %>\n				<div class="birdLocations hidden"><%= sighting.locations.join("<br />") %></div>\n			</td>\n			<td nowrap>\n				<div class="lastSeenSingle"><%=sighting.mostRecentObservationTime%></div>\n				<div class="lastSeenDetails hidden"><%=sighting.lastSeenArray.join("<br />") %></div>\n			</td>\n			<td>\n				<div class="howManySingle"><%=sighting.howManyCount%></div>\n				<div class="howManyDetails hidden"><%=sighting.howManyArray.join("<br />") %></div>\n			</td>\n		</tr>\n		<% }); %>\n		</tbody>\n	</table>\n</div>'}),define("text!singleBirdSightingsTableTemplate",[],function(){return'<div class="fixedHeader">\n	<div>\n		<h1>\n			<a href="#" class="showBirdSightingsTable"><%=L.sightings%></a> <span class="joiner">&raquo;</span> <%= locationName %>\n		</h1>\n		<h2><%= L.last %> <%= searchObservationRecency%> <% if (searchObservationRecency == 1) { %><%= L.day %><% } else { %><%= L.days %><% } %></h2>\n		<div class="clear"></div>\n	</div>\n</div>\n\n<div class="fixedContent">\n	<table class="birdSightingsTable table tablesorter table-striped table-hover" id="birdSightings">\n		<thead>\n			<th><%=L.species%></th>\n			<th><%=L.scientific_name%></th>\n			<th class="{ sorter: \'customdate\' }" width="140"><%=L.last_seen%></th>\n			<th width="80"><%=L.num_reported%></th>\n		</thead>\n		<tbody>\n		<% _.each(sightings, function(sighting, index) { %>\n		<tr>\n			<td class="species"><%=sighting.comName%></td>\n			<td><%=sighting.sciName%></td>\n			<td data-u="<%=sighting.obsDt_unixtime%>" nowrap><%=sighting.obsDateFormatted%></td>\n			<td><%=sighting.howMany%></td>\n		</tr>\n		<% }); %>\n		</tbody>\n	</table>\n</div>'}),define("text!notableSightingsTableTemplate",[],function(){return'<div class="fixedHeader">\n	<div>\n		<h1>\n			<% if (isSingleLocation) { %>\n			<a href="#" class="showNotableSightingsTable"><%=L.notable_sightings%></a>\n				<span class="joiner">&raquo;</span> <%= locationName %>\n			<% } else { %>\n				<%=L.notable_sightings%>\n			<% } %>\n		</h1>\n		<h2><%=L.last%> <%=searchObservationRecency%> <% if (searchObservationRecency == 1) { %><%=L.day%><% } else {%><%=L.days%><% } %></h2>\n		<div class="clear"></div>\n	</div>\n</div>\n\n<div class="fixedContent">\n	<table class="table tablesorter table-striped table-hover" id="notableSightings">\n		<thead>\n			<tr>\n				<% if (!isSingleLocation) { %><th>Location</th><% } %>\n				<th><%=L.species%></th>\n				<th>#</th>\n				<th><%=L.scientific_name%></th>\n				<th><%=L.reported_by%></th>\n				<th class="{ sorter: \'customdate\' }"><%=L.date%></th>\n				<th><%=L.status%></th>\n			</tr>\n		</thead>\n		<tbody>\n		<% _.each(sightings, function(sighting, index) { %>\n		<tr>\n			<% if (!isSingleLocation) { %><td><a href="#" class="filterNotableSightingByLocation" data-location-id="<%=sighting.locationID%>"><%=sighting.locationName%></a></td><% } %>\n			<td class="species"><%=sighting.comName%></td>\n			<td><%=sighting.howMany%></td>\n			<td><%=sighting.sciName%></td>\n			<td><%=sighting.reporterName%></td>\n			<td data-u="<%=sighting.obsDt_unixtime%>" nowrap><%=sighting.obsDt%></td>\n			<td>\n				<% if (sighting.obsValid) { %>\n					<span class="confirmed"><%=L.confirmed%></span>\n				<% } else if (sighting.obsReviewed) { %>\n					<span class="reviewed"><%=L.reviewed%></span>\n				<% } else if (!sighting.obsReviewed) { %>\n					<span class="not_reviewed"><%=L.not_reviewed%></span>\n				<% } %>\n			</td>\n		</tr>\n		<% }); %>\n		</tbody>\n	</table>\n</div>'}),define("text!notableSightingsInfoWindowTemplate",[],function(){return'<h4><%=locationName%></h4>\n\n<table class="dialogTable">\n	<tbody>\n	<% _.each(sightings, function(sighting, index) { %>\n	<tr>\n		<td style="padding-right:30px"><%=sighting.comName%></td>\n		<td><%=sighting.obsDt%></td>\n	</tr>\n	<% }); %>\n	</tbody>\n</table>\n\n<div class="dialogBottomLink">\n	<a href="#" class="viewNotableSightingDetails" data-location-id="<%=locationID%>"><%=L.view_full_info%> &raquo;</a>\n</div>'}),define("text!allSightingsInfoWindowTemplate",[],function(){return'<h4><%=locationName%></h4>\n\n<div class="dialogBottomLink">\n	<a href="#" class="viewLocationSightingDetails" data-location-id="<%=locationID%>"><%=L.view_bird_species%> <% if (numSpecies) { %><b>(<%=numSpecies%>)</b><% } %> &raquo;</a>\n</div>\n'}),define("map",["mediator","constants","moduleHelper","dataCache","text!notableSightingsInfoWindowTemplate","text!allSightingsInfoWindowTemplate"],function(e,t,n,r,i,s){var o="map",u,a,f="images/marker.png",l={zoom:4,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControlOptions:{mapTypeIds:[]},center:new google.maps.LatLng(40,-95),streetViewControl:!1,disableDefaultUI:!0,panControl:!0,zoomControl:!0,scaleControl:!0,overviewMapControl:!0},c="mapTab",h={},p=!1,d=0,v=[],m=[],g={searchType:null,latLng:null,observationRecency:null},y={all:{defaultZoomLevel:11,circleRadius:6e4,lastSearch:[],infoWindows:{},openInfoWindows:[],markers:{}},notable:{defaultZoomLevel:7,circleRadius:25e4,lastSearch:[],infoWindows:{},openInfoWindows:[],markers:{}},hotspots:{defaultZoomLevel:11,circleRadius:6e4,lastSearch:[],infoWindows:{},openInfoWindows:[],markers:{}}},b=function(){var r={};r[t.EVENT.WINDOW_RESIZE]=k,r[t.EVENT.TAB_CHANGED]=M,r[t.EVENT.SEARCH]=C,r[t.EVENT.LOCATION_MOUSEOVER]=U,r[t.EVENT.LOCATION_MOUSEOUT]=z,r[t.EVENT.LOCATION_CLICK]=W,e.subscribe(o,r),require([n.getCurrentLangFile()],function(e){h=e})},w=function(){google.maps.visualRefresh=!0,u=$("#mapTabContent")[0],a=new google.maps.Map(u,l),E(),S(),google.maps.event.addListener(a,"dragend",N),google.maps.event.addListener(a,"zoom_changed",N),e.publish(o,t.EVENT.TRIGGER_WINDOW_RESIZE)},E=function(){var e=$('<div class="mapBtn">Terrain</div>')[0],t=$('<div class="mapBtn mapBtnSelected">Road Map</div>')[0],n=$('<div class="mapBtn">Satellite</div>')[0],r=$('<div class="mapBtn">Hybrid</div>')[0];a.controls[google.maps.ControlPosition.TOP_RIGHT].push(r),a.controls[google.maps.ControlPosition.TOP_RIGHT].push(n),a.controls[google.maps.ControlPosition.TOP_RIGHT].push(t),a.controls[google.maps.ControlPosition.TOP_RIGHT].push(e),google.maps.event.addDomListener(e,"click",function(){a.setMapTypeId(google.maps.MapTypeId.TERRAIN),$(".mapBtn").removeClass("mapBtnSelected"),$(e).addClass("mapBtnSelected")}),google.maps.event.addDomListener(t,"click",function(){a.setMapTypeId(google.maps.MapTypeId.ROADMAP),$(".mapBtn").removeClass("mapBtnSelected"),$(t).addClass("mapBtnSelected")}),google.maps.event.addDomListener(n,"click",function(){a.setMapTypeId(google.maps.MapTypeId.SATELLITE),$(".mapBtn").removeClass("mapBtnSelected"),$(n).addClass("mapBtnSelected")}),google.maps.event.addDomListener(r,"click",function(){a.setMapTypeId(google.maps.MapTypeId.HYBRID),$(".mapBtn").removeClass("mapBtnSelected"),$(r).addClass("mapBtnSelected")})},S=function(){$(document).on("click",".viewNotableSightingDetails",x),$(document).on("click",".viewLocationSightingDetails",T)},x=function(n){n.preventDefault();var r=$(n.target).data("locationId");e.publish(o,t.EVENT.MAP.VIEW_NOTABLE_SIGHTING_SINGLE_LOCATION,{locationID:r})},T=function(n){n.preventDefault();var r=$(n.target).data("locationId");e.publish(o,t.EVENT.MAP.VIEW_SIGHTINGS_SINGLE_LOCATION,{locationID:r})},N=function(){if(p)return;R();switch(g.searchType){case"all":H("all",y.all.lastSearch),e.publish(o,t.EVENT.MAP.BIRD_MARKERS_ADDED,{locations:m,lastSearchObservationRecency:g.observationRecency});break;case"notable":H("notable",y.notable.lastSearch),e.publish(o,t.EVENT.MAP.NOTABLE_MARKERS_ADDED,{locations:m,lastSearchObservationRecency:g.observationRecency});break;case"hotspots":H("hotspots",y.hotspots.lastSearch),e.publish(o,t.EVENT.MAP.HOTSPOT_MARKERS_ADDED,{hotspots:m})}},C=function(e){g.searchType=e.data.resultType;var t=e.data.locationObj.lat(),n=e.data.locationObj.lng();g.latLng=e.data.locationObj,p=!0,e.data.viewportObj?a.fitBounds(e.data.viewportObj):a.setCenter(e.data.locationObj),a.setZoom(y[g.searchType].defaultZoomLevel),P(),g.searchType==="all"?(L({lat:t,lng:n,limitByObservationRecency:!0,observationRecency:e.data.searchOptions.allAndNotable.observationRecency}),g.observationRecency=e.data.searchOptions.allAndNotable.observationRecency):g.searchType==="notable"?(A({lat:t,lng:n,observationRecency:e.data.searchOptions.allAndNotable.observationRecency}),g.observationRecency=e.data.searchOptions.allAndNotable.observationRecency):g.searchType==="hotspots"&&(O({lat:t,lng:n,limitByObservationRecency:e.data.searchOptions.hotspots.limitByObservationRecency,observationRecency:e.data.searchOptions.hotspots.observationRecency}),g.observationRecency=e.data.searchOptions.hotspots.observationRecency)},k=function(e){var t=e.data;t.viewportMode=="desktop"?$("#panelContent").css("height",t.height-88):$("#panelContent").css("height",t.height-40)},L=function(i){$.ajax({url:"ajax/getHotspotLocations.php",data:i,type:"POST",dataType:"json",success:function(i){y.all.lastSearch=r.formatHotspotData(i),R(),H("all",y.all.lastSearch),p=!1,n.stopLoading(),e.publish(o,t.EVENT.MAP.BIRD_MARKERS_ADDED,{locations:m,lastSearchObservationRecency:g.observationRecency})},error:function(e){n.stopLoading()}})},A=function(i){$.ajax({url:"ajax/getNotableSightings.php",data:i,type:"POST",dataType:"json",success:function(i){y.notable.lastSearch=r.formatNotableSightingsData(i),R(),H("notable",y.notable.lastSearch),p=!1,n.stopLoading(),e.publish(o,t.EVENT.MAP.NOTABLE_MARKERS_ADDED,{locations:m,lastSearchObservationRecency:g.observationRecency})},error:function(e){n.stopLoading()}})},O=function(i){$.ajax({url:"ajax/getHotspotLocations.php",data:i,type:"POST",dataType:"json",success:function(i){y.hotspots.lastSearch=r.formatHotspotData(i),R(),H("hotspots",y.hotspots.lastSearch),p=!1,n.stopLoading(),e.publish(o,t.EVENT.MAP.HOTSPOT_MARKERS_ADDED,{hotspots:m})},error:function(e){n.stopLoading()}})},M=function(e){e.data.tab==="mapTab"&&D(),c=e.data.tab},D=function(){google.maps.event.trigger(a,"resize")},P=function(){d>0&&v[d-1].set("visible",!1),v[d]=new InvertedCircle({center:a.getCenter(),map:a,radius:y[g.searchType].circleRadius,editable:!1,stroke_weight:0,always_fit_to_map:!1}),d++},H=function(e,t){var n=a.getBounds(),r=new google.maps.LatLngBounds(n.getSouthWest(),n.getNorthEast());m=[];for(var i=0;i<t.length;i++){var s=t[i],o=s.locationID,u=new google.maps.LatLng(s.lat,s.lng);if(!r.contains(u))continue;e==="all"?B(o,u,s):e==="notable"?j(o,u,s):e==="hotspots"&&F(o,u,s),m.push(s)}},B=function(e,t,n){y.all.markers.hasOwnProperty(e)?y.all.markers[e].map===null&&y.all.markers[e].setMap(a):(y.all.markers[e]=new google.maps.Marker({position:t,map:a,title:n.n,icon:f,locationID:e}),y.all.infoWindows[e]=new google.maps.InfoWindow,function(e,t,n){google.maps.event.addListener(e,"click",function(){t.setContent(I(n)),t.open(a,this)})}(y.all.markers[e],y.all.infoWindows[e],n))},j=function(e,t,n){y.notable.markers.hasOwnProperty(e)?y.notable.markers[e].map===null&&y.notable.markers[e].setMap(a):(y.notable.markers[e]=new google.maps.Marker({position:t,map:a,title:n.n,icon:f,locationID:e}),y.notable.infoWindows[e]=new google.maps.InfoWindow,function(e,t,n){google.maps.event.addListener(e,"click",function(){t.setContent(q(n)),t.open(a,this)})}(y.notable.markers[e],y.notable.infoWindows[e],n))},F=function(e,t,n){y.hotspots.markers.hasOwnProperty(e)?y.hotspots.markers[e].map===null&&y.hotspots.markers[e].setMap(a):(y.hotspots.markers[e]=new google.maps.Marker({position:t,map:a,title:n.n,icon:f,locationID:e}),y.hotspots.infoWindows[e]=new google.maps.InfoWindow,function(e,t,n,r){google.maps.event.addListener(e,"click",function(){r=r.replace(/\s+/g,"&nbsp;"),t.setContent("<h4>"+r+"</h4>"),t.open(a,this)})}(y.hotspots.markers[e],y.hotspots.infoWindows[e],e,n.n))},I=function(e){var t=e.sightings.data[g.observationRecency-1].numSpeciesRunningTotal,n=_.template(s,{L:h,locationName:e.n,locationID:e.locationID,numSpecies:t});return n},q=function(e){var t=_.template(i,{L:h,sightings:e.sightings,locationName:e.n,locationID:e.locationID});return t},R=function(){for(var e in y.all.markers)y.all.markers[e].setMap(null);for(var e in y.notable.markers)y.notable.markers[e].setMap(null);for(var e in y.hotspots.markers)y.hotspots.markers[e].setMap(null)},U=function(e){var t=e.data.locationID;y[g.searchType].markers[t].setIcon("images/marker2.png"),y[g.searchType].markers[t].setZIndex(google.maps.Marker.MAX_ZINDEX+1)},z=function(e){var t=e.data.locationID;y[g.searchType].markers[t].setIcon("images/marker.png")},W=function(e){if(c!=="mapTab")return;var t=e.data.locationID,n=y[g.searchType].openInfoWindows,r=y[g.searchType].infoWindows,i=y[g.searchType].markers;$.inArray(t,n)!==-1?(r[t].close(),n.splice($.inArray(t,n),1)):(google.maps.event.trigger(i[t],"click"),n.push(t),g.searchType==="all"&&setTimeout(function(){$("#loc_"+t+"_numSpecies").html(e.data.numSpecies)},1e3))};return e.register(o,{init:b}),{create:w}}),define("mainPanel",["mediator","constants","underscore","moduleHelper","text!mainPanelTemplate","text!birdSightingsTableTemplate","text!singleBirdSightingsTableTemplate","text!notableSightingsTableTemplate","map"],function(e,t,n,r,i,s,o,u,a){var f="mainPanel",l="mapTab",c=null,h,p,d,v={},m=function(){var s={};s[t.EVENT.WINDOW_RESIZE]=S,s[t.EVENT.INIT_SEARCH]=g,s[t.EVENT.SELECT_TAB]=w,s[t.EVENT.MAP.VIEW_NOTABLE_SIGHTING_SINGLE_LOCATION]=N,s[t.EVENT.MAP.VIEW_SIGHTINGS_SINGLE_LOCATION]=C,s[t.EVENT.MAP.NOTABLE_MARKERS_ADDED]=A,s[t.EVENT.MAP.HOTSPOT_MARKERS_ADDED]=O,s[t.EVENT.LOCATION_CLICK]=M,s[t.EVENT.BIRD_SIGHTINGS_LOADED]=D,e.subscribe(f,s),require([r.getCurrentLangFile()],function(e){v=e;var r=e.site_not_affiliated_with_ebird.replace(/%1/,'<a href="http://ebird.org" target="_blank">eBird.org</a>'),s=n.template(i,{L:v,eBirdText:r,githubUrl:t.CORE.GITHUB_URL,appVersion:t.CORE.APP_VERSION});$("#mainPanel").html(s),y(),a.create()})},g=function(n){E("mapTab"),h=n.data,e.publish(f,t.EVENT.SEARCH,n.data)},y=function(){$("#panelTabs").on("click","li",b),$("#birdSpeciesTabContent").on("click",".filterNotableSightingByLocation",function(e){e.preventDefault();var t=$(e.target).data("locationId");k(t)}),$("#birdSpeciesTabContent").on("click",".showNotableSightingsTable",function(e){e.preventDefault(),x()}),$("#birdSpeciesTabContent").on("click",".toggleBirdSpeciesLocations",H),$("#birdSpeciesTabContent").on("click",".showBirdSightingsTable",function(e){e.preventDefault(),T()})},b=function(e){var t=e.target;if($(t).hasClass("disabledTab"))return;var n=$(t).attr("id");E(n)},w=function(e){E(e.data.tabID)},E=function(n){if(n===l)return;$("#panelTabs li").removeClass("btn-primary"),$("#"+n).addClass("btn-primary"),$("#"+l+"Content").addClass("hidden"),$("#"+n+"Content").removeClass("hidden"),l=n,e.publish(f,t.EVENT.TAB_CHANGED,{tab:l})},S=function(e){if(e.data.viewportMode==="desktop")$("#locationsTab").addClass("hidden"),$("#mainPanel").css({height:e.data.height-54,width:e.data.width-318});else{$("#locationsTab").removeClass("hidden");var t=e.data.height-210;$("#mainPanel").css({height:t+"px",width:"100%"})}},x=function(){var e=[];for(var t=0;t<c.locations.length;t++){var r=c.locations[t];for(var i=0;i<r.sightings.length;i++){var s=r.sightings[i];s.locationName=r.n,s.locationID=r.locationID,e.push(s)}}var o=n.template(u,{isSingleLocation:!1,searchObservationRecency:c.lastSearchObservationRecency,sightings:e,L:v});$("#birdSpeciesTab").html(v.bird_sightings+" ("+e.length+")"),$("#birdSpeciesTabContent").html(o),B("#notableSightings")},T=function(){var e={},t=0;for(var r in p){if(!p[r].sightings.success)continue;var i=_(r,d);for(var o in i.species){var u=i.species[o];e.hasOwnProperty(o)||(e[o]={comName:u.comName,sciName:o,obs:[],locations:[],mostRecentObservationTime:null,howManyCount:0},t++),e[o].obs.push({howMany:u.howMany,lat:u.lat,lng:u.lng,locID:u.locID,locName:u.locName,obsDt:u.obsDt,obsReviewed:u.obsReviewed,obsValid:u.obsValid}),e[o].locations.push(u.locName)}}var a=[];for(var f in e)a.push(e[f]);a.sort(function(e,t){return e.comName.toLowerCase()>t.comName.toLowerCase()?1:-1});var l=[];for(var c=0;c<a.length;c++){var h=0,m=[],g=[];for(var y=0;y<a[c].obs.length;y++){var b=parseInt(moment(a[c].obs[y].obsDt,"YYYY-MM-DD HH:mm").format("X"),10);b>h&&(h=b,a[c].mostRecentObservationTime=moment(a[c].obs[y].obsDt,"YYYY-MM-DD HH:mm").format("MMM Do, H:mm a")),g.push(moment(a[c].obs[y].obsDt,"YYYY-MM-DD HH:mm").format("MMM Do, H:mm a")),howMany=a[c].obs[y].howMany||"-",howMany.toString().match(/\D/g)?(howManyCount="-",m.push("-")):(m.push(a[c].obs[y].howMany),a[c].howManyCount+=parseInt(a[c].obs[y].howMany,10))}a[c].howManyArray=m,a[c].lastSeenArray=g,l.push(a[c])}var w=n.template(s,{isSingleLocation:!1,searchObservationRecency:d,sightings:l,L:v});$("#birdSpeciesTabContent").html(w),B("#birdSightings")},N=function(e){var t=e.data.locationID;k(t)},C=function(e){var t=e.data.locationID;L(t)},k=function(e){var t=c.lastSearchObservationRecency,r=[],i=null,s=null,o=null;for(var a=0;a<c.locations.length;a++){if(c.locations[a].locationID!==e)continue;i=c.locations[a].n,s=c.locations[a].lat,o=c.locations[a].lng,r=c.locations[a].sightings;break}var f=n.template(u,{isSingleLocation:!0,locationName:i,lat:s,lng:o,searchObservationRecency:t,sightings:r,L:v});$("#birdSpeciesTabContent").html(f),B("#notableSightings"),E("birdSpeciesTab")},L=function(e){var t=h.searchOptions.allAndNotable.observationRecency,r=_(e,t),i=[];for(var s in r.species){var u=moment(r.species[s].obsDt,"YYYY-MM-DD HH:mm").format("MMM Do, H:mm a");r.species[s].obsDt_unixtime=moment(r.species[s].obsDt,"YYYY-MM-DD HH:mm").unix(),r.species[s].obsDateFormatted=u,i.push(r.species[s])}i.sort(function(e,t){return e.comName.toLowerCase()>t.comName.toLowerCase()?1:-1});var a=n.template(o,{isSingleLocation:!0,locationName:p[e].n,lat:p[e].lat,lng:p[e].lng,searchObservationRecency:t,sightings:i,L:v});$("#birdSpeciesTabContent").html(a),E("birdSpeciesTab"),B("#birdSightings")},A=function(e){c=e.data;var t=e.data.locations.length;t>0?($("#birdSpeciesTab").addClass("btn").removeClass("hidden"),x()):$("#birdSpeciesTab").addClass("hidden").removeClass("btn")},O=function(e){_lastBirdSearch=e.data,$("#birdSpeciesTab").html(v.bird_species).removeClass("btn").addClass("hidden disabledTab")},M=function(e){if(l!=="birdSpeciesTab")return;var t=e.data.locationID;h.resultType==="all"?L(t):h.resultType==="notable"&&k(t)},_=function(e,t){if(!p.hasOwnProperty(e))return!1;var n={},r=0;for(var i=0;i<t;i++){var s=p[e].sightings.data[i].obs;for(var o=0;o<s.length;o++)n.hasOwnProperty(s[o].sciName)||(n[s[o].sciName]=s[o],r++)}return{numSpecies:r,species:n}},D=function(e){p=$.extend(!0,{},e.data.birdData),d=e.data.observationRecency;var t=P();t>0&&($("#birdSpeciesTab").html(v.bird_species+" ("+t+")").removeClass("hidden disabledTab").addClass("btn"),T())},P=function(){var e={},t=0;for(var n in p){var r=p[n].sightings.data;for(var i=0;i<=d-1;i++){var s=r[i].obs;for(var o=0;o<s.length;o++)e.hasOwnProperty(s[o].sciName)||(e[s[o].sciName]=null,t++)}}return t},H=function(e){e.preventDefault(),$(e.target).html()==="(+)"?($(e.target).html("(-)"),$(".birdLocations").removeClass("hidden"),$(".lastSeenSingle,.howManySingle").css("visibility","hidden"),$(".lastSeenDetails,.howManyDetails").removeClass("hidden")):($(e.target).html("(+)"),$(".birdLocations").addClass("hidden"),$(".lastSeenSingle,.howManySingle").css("visibility","visible"),$(".lastSeenDetails,.howManyDetails").addClass("hidden"))},B=function(e){try{$(e).trigger("destroy")}catch(t){}$(e).tablesorter(),$("#birdSpeciesTabContent .toggleBirdSpeciesLocations").on("mouseup",function(e){e.stopImmediatePropagation()})};e.register(f,{init:m})}),define("text!aboutTemplate",[],function(){return'<div id="aboutDialog" class="modal hide <%=className%>" tabindex="-1" role="dialog" aria-labelledby="aboutDialog" aria-hidden="true">\n	<div class="modal-header">\n		<ul id="aboutDialogTabs">\n			<li data-tab="help" class="btn btn-primary"><%=L.help%></li>\n			<li data-tab="about" class="btn btn-primary"><%=L.about_birdsearch%></li>\n			<li data-tab="thanks" class="btn"><%=L.thanks%></li>\n			<li data-tab="translate" class="btn"><%=L.help_translate%></li>\n			<li data-tab="contact" class="btn"><%=L.contact%></li>\n		</ul>\n	</div>\n	<div class="modal-body">\n\n		<div class="modalTab" id="helpTabContent">\n			<h2>Help</h2>\n\n		</div>\n\n		<div class="modalTab" id="aboutTabContent">\n			<h2><%=L.about_birdsearch%> <span id="appVersion">(<%=version%>)</span></h2>\n\n			<div class="decorationImage">\n				<img src="images/magenta_throated_woodstar.png" />\n				<div>Magenta-throated Woodstar, Costa Rica 2012</div>\n			</div>\n\n			<p>\n				<%=about_para1%>\n			</p>\n			<p>\n				<%=L.about_para2%>\n			</p>\n			<p>\n				<%=L.about_para3%>\n			</p>\n			<p>\n				<%=about_para4%>\n			</p>\n			<p>\n				<%=L.have_fun%>\n			</p>\n			<p>\n				- <a href="http://www.benjaminkeen.com" target="_blank">Ben Keen</a>, August 2013\n			</p>\n		</div>\n\n		<div class="modalTab hidden" id="thanksTabContent">\n			<h2><%=L.thanks_homies%></h2>\n			<p>\n				<%=L.thanks_blurb%>\n			</p>\n\n			<ul style="float:left; width: 47%">\n				<li><a href="http://requirejs.org/" target="_blank">RequireJS</a> - JS AMD dependency loader</li>\n				<li><a href="http://jquery.com/" target="_blank">jQuery</a></li>\n				<li><a href="http://jqueryui.com/" target="_blank">jQuery UI</a></li>\n				<li><a href="http://tablesorter.com/docs/" target="_blank">jQuery tablesorter</a></li>\n				<li><a href="https://code.google.com/p/html5shiv/" target="_blank">html5shiv</a></li>\n				<li><a href="http://modernizr.com/" target="_blank">Modernizr</a></li>\n			</ul>\n\n			<ul style="float:left">\n				<li><a href="http://underscorejs.org/" target="_blank">Underscore</a></li>\n				<li><a href="https://github.com/raihan2006i/google-map-inverted-circle" target="_blank">Google Maps inverted circle</a></li>\n				<li><a href="http://getbootstrap.com/2.3.2/" target="_blank">Bootstrap</a>, modals and transition</li>\n				<li><a href="bootswatch.com/cyborg/" target="_blank">Bootstrap, cyborg theme</a> (heavily modded)</li>\n				<li><a href="http://sass-lang.com/" target="_blank">Sass</a></li>\n				<li><a href="https://github.com/benkeen/spinners" target="_blank">Spinners</a> - my own fork</li>\n			</ul>\n			<div class="clear"></div>\n\n			<p>\n				<%=L.thanks_footer%>\n			</p>\n		</div>\n\n		<div class="modalTab hidden" id="contactTabContent">\n			<h2><%=L.contact%></h2>\n\n			<p>\n				<%=L.contact_me_para%>\n			</p>\n			<p>\n				<%=L.make_comment%>\n			</p>\n			<p>\n				<%=L.thanks%>\n			</p>\n		</div>\n\n		<div class="modalTab hidden" id="translateTabContent">\n			<h2><%=L.help_translate%></h2>\n\n			<p>\n				<%=L.translate_para1%>\n			</p>\n			<p>\n				<%=L.translate_para2%>\n			</p>\n		</div>\n\n	</div>\n	<div class="modal-footer">\n		<a href="#" onclick="return false;" data-dismiss="modal" data-target="#aboutDialog" class="btn btn-info"><%=L.close%></a>\n	</div>\n</div>'}),define("aboutDialog",["mediator","constants","moduleHelper","text!aboutTemplate"],function(e,t,n,r){var i="aboutDialog",s="about",o={},u=function(){require([n.getCurrentLangFile()],function(e){o=e;var n=e.about_para1.replace(/%1/,'<a href="http://ebird.org" target="_blank">eBird.org</a>'),i=e.about_para4.replace(/%1/,'<a href="'+t.CORE.GITHUB_URL+'" target="_blank">github</a>'),s="fade";$.browser.msie&&(s="");var u=_.template(r,{L:o,version:t.CORE.APP_VERSION,className:s,about_para1:n,about_para4:i});$("body").append(u),$(document).on("click","#aboutDialogTabs li",a)})},a=function(e){var t=$(e.target).data("tab");$("#aboutDialogTabs").find("li").removeClass("btn-primary"),$(e.target).addClass("btn-primary"),$("#"+s+"TabContent").addClass("hidden"),$("#"+t+"TabContent").removeClass("hidden"),s=t};e.register(i,{init:u})}),require(["mediator","page","dataCache","header","sidebar","mainPanel","aboutDialog"],function(e){$(function(){$.tablesorter.addParser({id:"customdate",is:function(){return!1},format:function(e,t,n,r){var i=$(n).data("u");if(i)return parseInt(i,10)},type:"numeric"}),$.tablesorter.addParser({id:"species",is:function(){return!1},format:function(e,t,n){return $(n).find("div").text()},type:"numeric"}),e.start()})}),define("core/appStart",function(){});